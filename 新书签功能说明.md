# 新书签功能说明

## 功能概述

书签功能已重新设计，现在可以对选中的文本内容添加书签，并用虚线框标记。

## 使用方法

### 1. 添加书签
1. 在编辑器中**选中**要添加书签的文本内容
2. 点击工具栏右侧的书签按钮 📖
3. 在弹出的面板中输入书签名称（可选，不输入则自动命名为"书签1"、"书签2"等）
4. 点击"添加"按钮或按回车键

**重要：** 必须先选中文本才能添加书签，否则会提示"请先选中要添加书签的内容"

### 2. 书签显示
- 添加书签后，选中的文本会显示**橙色虚线框**
- 虚线框内有浅橙色背景
- 鼠标悬停时背景色会加深

### 3. 查看书签
- 点击工具栏的书签按钮查看当前页面的所有书签
- 点击左侧图标栏的书签图标 📖 查看所有页面的书签

### 4. 跳转到书签
- 在书签列表中点击任意书签
- 编辑器会自动选中该书签对应的文本
- 并滚动到对应位置

### 5. 删除书签
- 在书签列表中点击书签右侧的删除按钮
- 确认删除后，文本上的虚线框也会消失

## 视觉效果

### 书签标记样式
```
这是普通文本 [这是书签内容] 这是普通文本
                ↑
            橙色虚线框
          浅橙色背景
```

- **边框**：2px 橙色虚线 (#fa8c16)
- **背景**：浅橙色半透明 (rgba(250, 140, 22, 0.1))
- **圆角**：3px
- **内边距**：2px 4px
- **悬停效果**：背景色加深

## 技术实现

### 自定义格式
- 使用 Quill 的自定义 Blot 实现书签格式
- 书签格式名称：`bookmark`
- HTML 标签：`<span class="ql-bookmark">`
- 保存书签 ID 在 `data-bookmark-id` 属性中

### 数据结构
```typescript
interface Bookmark {
  id: string;        // 唯一标识
  name: string;      // 书签名称
  position: number;  // 起始位置
  length: number;    // 选中的长度
  createdAt: number; // 创建时间
}
```

## 优势特点

1. **直观可见**：
   - 书签直接显示在文本上
   - 虚线框清晰标识书签范围

2. **精确定位**：
   - 保存选中文本的起始位置和长度
   - 跳转时精确选中原文本

3. **不干扰编辑**：
   - 书签是文本格式，不影响编辑
   - 可以正常编辑书签内的文本

4. **自动更新**：
   - 编辑内容时书签格式自动跟随
   - 删除书签时格式自动清除

5. **视觉友好**：
   - 橙色虚线框醒目但不突兀
   - 悬停效果提供交互反馈

## 使用场景

- **重点标记**：标记文档中的重要段落
- **待办提醒**：标记需要后续处理的内容
- **引用参考**：标记需要引用的文字
- **协作标注**：标记需要讨论的部分

## 与旧版本的区别

### 旧版本（左侧标记）
- 在行首显示橙色竖条
- 只标记行位置
- 不显示具体内容

### 新版本（虚线框）
- 直接在文本上显示虚线框
- 精确标记选中的内容
- 更直观易用
