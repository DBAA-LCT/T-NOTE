# 修改日志

## [2.0.0] - 2024-02-04

### 🎨 重大更新：UI 全面升级

#### ✨ 新增功能
- 集成 Ant Design 6.0 组件库
- 添加图标系统 (@ant-design/icons)
- 中文语言包配置
- 自定义主题配置（蓝色主题）
- 删除确认对话框
- 页面更新时间显示
- 友好的空状态提示
- 非阻塞式消息提示

#### 🎨 界面改进

**侧边栏**
- 使用 Ant Design Layout.Sider 组件
- 优化按钮布局和样式
- 添加图标辅助识别
- 卡片式页面列表
- 悬停效果和选中状态
- 显示页面更新时间
- 优化搜索框样式

**编辑器**
- 使用 Ant Design Layout.Content 组件
- 大号标题输入框
- 彩色标签系统
- 优化标签管理界面
- 改进富文本编辑器样式
- 友好的空状态提示

**整体布局**
- 统一的配色方案
- 优化间距和排版
- 改进滚动条样式
- 响应式设计

#### 🔧 技术改进
- 使用 Ant Design 组件替代原生 HTML
- 统一的设计系统
- 更好的 TypeScript 类型支持
- 优化的 CSS 样式
- 改进的代码结构

#### 🐛 修复
- 修复样式不一致问题
- 优化富文本编辑器显示
- 改进代码块样式

---

## [1.5.0] - Tab 栏和分屏功能

### ✨ 新增功能

#### 页面 Tab 栏
- 在编辑器顶部显示已打开页面的 Tab 栏
- 最多显示 5 个 Tab，超过 5 个会显示 "+N" 提示
- 点击 Tab 可以切换页面
- 每个 Tab 显示页面标题
- 当前激活的 Tab 会高亮显示（蓝色边框）
- Tab 可以关闭（点击 × 按钮）

#### 右键菜单
- 右键点击 Tab 显示上下文菜单
- 菜单选项：分屏显示、关闭

#### 分屏编辑
- 左右分屏显示两个页面
- 独立编辑，实时保存
- 关闭分屏按钮
- 延迟加载避免冲突（100ms）

#### Tab 拖拽手势
- **水平拖动排序**：在 Tab 栏内拖动 Tab 可以调整顺序
- **向右拖动分屏**：将 Tab 向右拖动超过 100px 后松开，自动分屏显示
- 被拖动的 Tab 变为半透明
- 目标位置显示蓝色左边框提示
- 拖动距离超过 100px 时，右侧显示蓝色提示框

#### Tab 拖放区域
- 在 Tab 栏右侧添加专门的分屏拖放区域
- 图标：双栏分屏图标
- 文字："拖到这里分屏"
- 拖动经过时高亮显示
- 轻微放大效果（scale: 1.05）

#### IDEA 风格双 Tab 栏
- 左右两侧各有独立的 Tab 栏
- Tab 只在对应侧显示，不会重复
- 拖拽 Tab 可以在两侧之间移动
- 自动全屏：一侧 Tab 全部关闭时，另一侧自动全屏

#### 焦点切换分屏
- 同一时间只有一个编辑器处于可编辑状态
- 点击任意一侧，该侧变为可编辑，另一侧自动变为只读预览
- 避免了 ReactQuill 多实例冲突
- 保持了双向编辑能力

#### 只读分屏方案
- 左侧：完整的可编辑 Editor 组件
- 右侧：轻量级的只读 ReadOnlyEditor 组件
- 完全避免 ReactQuill 多实例冲突
- 无延迟，即时显示
- 性能更好，资源占用更少

### 🔧 技术实现

#### 新增组件
- `PageTabs.tsx`：Tab 栏组件
- `PageTabs.css`：Tab 栏样式
- `ReadOnlyEditor.tsx`：只读编辑器组件
- `ReadOnlyEditor.css`：只读编辑器样式

#### 状态管理
- `openTabs`：已打开的 Tab 列表（页面 ID 数组）
- `leftTabs`：左侧 Tab 列表
- `rightTabs`：右侧 Tab 列表
- `activeLeftTab`：左侧激活的 Tab
- `activeRightTab`：右侧激活的 Tab
- `splitViewPageId`：分屏显示的页面 ID
- `activeSide`：当前激活的编辑器侧（'left' | 'right'）
- `draggedTab`：正在拖动的 Tab
- `isDraggingToSplit`：是否正在拖动到分屏区域

#### 主要函数
- `handleTabClick`：切换 Tab
- `handleTabClose`：关闭 Tab
- `handleSplitView`：切换分屏显示
- `handleSelectPage`：选择页面时自动添加到 Tab 栏
- `handleDragStart`：开始拖拽
- `handleDrag`：拖拽中
- `handleDrop`：放下

### 🐛 修复

#### 分屏功能错误修复
- 添加 splitPage 存在性检查
- 使用独特的 key 值（添加 "split-" 前缀）
- 简化 onUpdatePage 回调

#### 分屏功能白屏问题修复 V2
- 添加 stripHtml 错误处理
- 防止 Quill 格式重复注册
- 分屏延迟加载（100ms）
- 添加加载提示

### 📝 文档
- 添加 `TAB_FEATURE.md`：Tab 功能说明
- 添加 `TAB_USAGE.md`：Tab 使用指南
- 添加 `TAB_AND_SPLIT_SUMMARY.md`：Tab 栏和分屏功能完整说明
- 添加 `TAB_DRAG_GESTURES.md`：Tab 拖拽手势功能说明
- 添加 `TAB_DRAG_DROP_ZONE.md`：Tab 拖放区域功能说明
- 添加 `SPLIT_VIEW_FIX.md`：分屏功能错误修复说明
- 添加 `SPLIT_VIEW_FIX_V2.md`：分屏功能白屏问题修复 V2
- 添加 `READONLY_SPLIT_VIEW.md`：只读分屏方案说明
- 添加 `SPLIT_TAB_DESIGN.md`：分屏 Tab 设计说明
- 添加 `FOCUS_SWITCH_SPLIT.md`：焦点切换分屏功能说明
- 添加 `IDEA_STYLE_DUAL_TABS.md`：IDEA 风格双 Tab 栏系统
- 添加 `FINAL_DUAL_TAB_SYSTEM.md`：最终双 Tab 栏系统说明

---

## [1.4.0] - TODO 功能

### ✨ 新增功能

#### TODO 面板
- 添加待办事项管理功能
- 支持标题、描述、优先级、分类、截止日期
- 完成/取消完成功能
- 编辑和删除功能
- 按状态和优先级过滤
- 统计信息显示
- 优先级标识（高/中/低）
- 截止日期提醒
- 自动排序

#### 数据持久化
- TODO 数据保存在笔记文件中
- 与笔记一起自动保存
- 支持跨设备同步（通过笔记文件）

### 🔧 技术实现
- 新增 `TodoPanel.tsx` 组件
- 集成 dayjs 日期处理库
- 添加 TodoItem 数据结构

### 📝 文档
- 添加 `TODO功能说明.md`

---

## [1.3.0] - 书签功能

### ✨ 新增功能
- 在编辑器中添加书签标记
- 书签面板显示所有书签
- 点击书签快速定位到对应位置
- 书签高亮显示

---

## [1.2.0] - 搜索功能

### ✨ 新增功能
- 按标签搜索页面
- 实时过滤显示结果
- 搜索面板展示匹配的页面

---

## [1.1.0] - 图标栏

### ✨ 新增功能
- 添加左侧图标栏
- 页面列表图标
- 搜索图标
- 书签图标
- TODO 图标

---

## [1.0.0] - 初始版本

### ✨ 核心功能
- 富文本笔记编辑
- 多页面管理
- 标签系统
- 文件保存和打开
- 按标签搜索
- Ctrl+S 快捷键保存

### 🔧 技术栈
- React 18
- TypeScript 5
- Electron 28
- React Quill 2.0
- Vite 5

---

## 版本说明

### 版本号规则
遵循语义化版本 (Semantic Versioning)：
- 主版本号：重大更新，可能包含不兼容的改动
- 次版本号：新增功能，向后兼容
- 修订号：问题修复，向后兼容

### 更新类型
- ✨ 新增功能
- 🎨 界面改进
- 🔧 技术改进
- 🐛 问题修复
- 📝 文档更新
- ⚡ 性能优化
- 🔒 安全更新

---

## 未来计划

### v2.1.0（计划中）
- [ ] 添加暗色主题
- [ ] 支持笔记导出（PDF、Markdown）
- [ ] 添加快捷键面板
- [ ] 优化大文件加载性能
- [ ] 支持拖拽调整分屏比例
- [ ] 支持上下分屏
- [ ] 支持超过 5 个 Tab 的滚动
- [ ] 添加键盘快捷键切换编辑器

### v2.2.0（计划中）
- [ ] 笔记本分组功能
- [ ] 笔记加密功能
- [ ] 历史版本管理
- [ ] 附件上传功能
- [ ] 支持三栏、四栏布局
- [ ] 支持 Tab 组（Tab Groups）
- [ ] 支持固定 Tab（Pinned Tabs）

### v3.0.0（远期规划）
- [ ] 云同步功能
- [ ] 多设备协同
- [ ] 笔记分享功能
- [ ] 移动端支持

---

## 致谢

感谢以下开源项目：
- [Ant Design](https://ant.design/) - 企业级 UI 设计语言和 React 组件库
- [React](https://react.dev/) - 用于构建用户界面的 JavaScript 库
- [Electron](https://www.electronjs.org/) - 使用 Web 技术构建跨平台桌面应用
- [Quill](https://quilljs.com/) - 强大的富文本编辑器
- [Vite](https://vitejs.dev/) - 下一代前端构建工具
- [dayjs](https://day.js.org/) - 轻量级日期处理库
